From 976ab1f4c916099fc1f2e6569f13e45df2f26b4f Mon Sep 17 00:00:00 2001
From: Peter Hunt <pehunt@redhat.com>
Date: Tue, 26 Mar 2024 12:07:17 -0400
Subject: [PATCH] annotations: add OCI runtime specific annotations to the
 AllowedAnnotations

meaning an admin would have to opt-into allowing them to be used

Signed-off-by: Peter Hunt <pehunt@redhat.com>
---
 pkg/annotations/annotations.go | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/pkg/annotations/annotations.go b/pkg/annotations/annotations.go
index 51920eb..e517f18 100644
--- a/pkg/annotations/annotations.go
+++ b/pkg/annotations/annotations.go
@@ -48,4 +48,17 @@ var AllAllowedAnnotations = []string{
 	OCISeccompBPFHookAnnotation,
 	rdt.RdtContainerAnnotation,
 	TrySkipVolumeSELinuxLabelAnnotation,
+	// Keep in sync with
+	// https://github.com/opencontainers/runc/blob/3db0871f1cf25c7025861ba0d51d25794cb21623/features.go#L67
+	// Once runc 1.2 is released, we can use the `runc features` command to get this programatically,
+	// but we should hardcode these for now to prevent misuse.
+	"bundle",
+	"org.systemd.property.",
+	"org.criu.config",
+
+	// Simiarly, keep in sync with
+	// https://github.com/containers/crun/blob/475a3fd0be/src/libcrun/container.c#L362-L366
+	"module.wasm.image/variant",
+	"io.kubernetes.cri.container-type",
+	"run.oci.",
 }
-- 
2.33.8

